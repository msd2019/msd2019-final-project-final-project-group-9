---
title: "MSD 2019 Final Project"
subtitle: "A replication and extension of < PAPER TITLE > by < ORIGINAL AUTHORS >, < PUBLISHED IN >"
author: "Your Names (your unis)"
date: '`r Sys.time()`'
output:
  pdf_document:
    toc: yes
    toc_depth: 3
---

```{r}
library(tidyverse)
library(modelr)
library(ggplot2)
library(igraph)

```



Make a loop that uses the same code for the three departments
```{r}
top15 = data.frame()
rest = data.frame()


for( dep in c('ComputerScience','Business', 'History' ) ){

edgelist = read.table( paste(dep, '_edgelist.txt', sep = ""), header = FALSE,  col.names = c('u', 'v', 'rank', 'gender'))

vertex = read.table(file  = paste(dep, '_vertexlist.txt', sep = ""), sep = '\t', header = FALSE, col.names = c('u', 'pi', 'USN2009', 'NRC2010', 'Region', 'institution'))


weighted_edgelist = edgelist %>% 
  group_by(v, u) %>%
  summarize( count = n()) %>%
  ungroup() %>%
  left_join( bus_vertex, by = c('v'= 'u')) %>%
  select(v, u, count, institution)


smaller = weighted_edgelist %>%
  filter( u <= 10 , v <= 10 )

graph = weighted_edgelist %>%
  graph_from_data_frame(directed = TRUE)


smaller_graph = smaller %>%
   graph_from_data_frame(directed = TRUE)


plot(smaller_graph, vertex_size = 2 ,edge.width=E(smaller_graph)$count/2,
     layout = layout_in_circle(smaller_graph, order = V(smaller_graph)), 
     vertex.label = unique( E(smaller_graph)$institution )
     )

edgelist$dep = dep

num_schools = max(edgelist$u)


top15 = rbind(top15,  edgelist %>%
  filter(u <= .15*num_schools) %>%
  mutate(diff = (v - u)/num_schools) %>%
  select(diff, dep)
  )


rest = rbind(rest,  edgelist %>%
  filter(u > .15*num_schools) %>%
  filter( u < num_schools ) %>%
  mutate(diff = (v - u)/num_schools) %>%
  select(diff, dep)
  )


}
```

```{r}
top15 %>%
  ggplot(aes(x = diff, color = dep)) +
  geom_density()


rest %>%
  ggplot(aes(x = diff, color = dep)) +
  geom_density()


```







The following is a list of all packages used to generate these results. (Leave at very end of file.)

```{r}
sessionInfo()
```